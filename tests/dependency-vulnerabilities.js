// 依赖漏洞示例文件

// 示例 1: 过时的依赖版本
{
  "dependencies": {
    "vue": "2.6.14",
    "axios": "0.19.2",
    "lodash": "4.17.15",
    "moment": "2.24.0",
    "express": "4.16.4"
  }
}

// 示例 2: 已知漏洞的依赖
{
  "dependencies": {
    "lodash": "4.17.15",
    "minimist": "1.2.5",
    "axios": "0.21.1",
    "node-fetch": "2.6.1",
    "yargs-parser": "18.1.2"
  }
}

// 示例 3: 弃用的依赖
{
  "dependencies": {
    "jquery": "3.5.1",
    "bootstrap": "4.6.0",
    "popper.js": "1.16.1",
    "moment": "2.29.1",
    "date-fns": "2.16.1"
  }
}

// 示例 4: 不安全的依赖配置
{
  "dependencies": {
    "vue": "^2.6.0",
    "vuex": "^3.0.0",
    "vue-router": "^3.0.0",
    "axios": "^0.19.0"
  },
  "devDependencies": {
    "webpack": "^4.0.0",
    "babel-loader": "^8.0.0",
    "css-loader": "^3.0.0"
  }
}

// 示例 5: 缺少安全更新的依赖
{
  "dependencies": {
    "react": "16.13.1",
    "react-dom": "16.13.1",
    "styled-components": "5.1.1",
    "redux": "4.0.5",
    "react-redux": "7.2.0"
  }
}

// 示例 6: 使用通配符版本的依赖
{
  "dependencies": {
    "vue": "*",
    "axios": "*",
    "lodash": "*",
    "moment": "*"
  }
}

// 示例 7: 使用不稳定的版本
{
  "dependencies": {
    "vue": "2.7.0-beta.1",
    "vuex": "4.0.0-alpha.1",
    "vue-router": "4.0.0-beta.8",
    "axios": "0.22.0-rc.1"
  }
}

// 示例 8: 使用本地路径的依赖
{
  "dependencies": {
    "vue": "file:../vue",
    "vuex": "file:../vuex",
    "vue-router": "file:../vue-router"
  }
}

// 示例 9: 使用Git仓库的依赖
{
  "dependencies": {
    "vue": "git+https://github.com/vuejs/vue.git",
    "vuex": "git+https://github.com/vuejs/vuex.git",
    "vue-router": "git+https://github.com/vuejs/vue-router.git"
  }
}

// 示例 10: 使用未验证的依赖
{
  "dependencies": {
    "unverified-package": "1.0.0",
    "suspicious-module": "2.0.0",
    "unknown-library": "3.0.0"
  }
}

// 示例 11: package.json中的依赖漏洞
const packageJson = {
  "name": "vulnerable-app",
  "version": "1.0.0",
  "dependencies": {
    "lodash": "4.17.15",
    "axios": "0.21.1",
    "moment": "2.29.1",
    "express": "4.17.1",
    "body-parser": "1.19.0"
  },
  "devDependencies": {
    "webpack": "4.46.0",
    "babel-loader": "8.2.2",
    "css-loader": "5.2.6"
  }
};

// 示例 12: yarn.lock中的依赖漏洞
const yarnLock = `
# THIS IS AN AUTOGENERATED FILE. DO NOT EDIT THIS FILE DIRECTLY.
# yarn lockfile v1

"lodash@npm:4.17.15":
  version "4.17.15"
  resolved "https://registry.yarnpkg.com/lodash/-/lodash-4.17.15.tgz"
  integrity sha512-xxx

"axios@npm:0.21.1":
  version "0.21.1"
  resolved "https://registry.yarnpkg.com/axios/-/axios-0.21.1.tgz"
  integrity sha512-xxx
`;

// 示例 13: package-lock.json中的依赖漏洞
const packageLockJson = {
  "name": "vulnerable-app",
  "version": "1.0.0",
  "lockfileVersion": 2,
  "requires": true,
  "packages": {
    "node_modules/lodash": {
      "version": "4.17.15",
      "resolved": "https://registry.npmjs.org/lodash/-/lodash-4.17.15.tgz",
      "integrity": "sha512-xxx"
    },
    "node_modules/axios": {
      "version": "0.21.1",
      "resolved": "https://registry.npmjs.org/axios/-/axios-0.21.1.tgz",
      "integrity": "sha512-xxx"
    }
  }
};

// 示例 14: Vue组件中的依赖导入
export default {
  name: 'DependencyVulnerableComponent',
  mounted() {
    import('lodash').then(_ => {
      console.log('lodash loaded');
    });
    
    import('axios').then(axios => {
      axios.get('/api/data');
    });
    
    import('moment').then(moment => {
      console.log(moment().format());
    });
  }
};

// 示例 15: 动态导入不安全的依赖
export function loadVulnerableDependency() {
  return import('lodash');
}

export function loadOutdatedDependency() {
  return import('axios');
}

export function loadDeprecatedDependency() {
  return import('moment');
}

// 示例 16: 使用require加载依赖
const lodash = require('lodash');
const axios = require('axios');
const moment = require('moment');

// 示例 17: 使用ES6 import加载依赖
import _ from 'lodash';
import axios from 'axios';
import moment from 'moment';

// 示例 18: 条件加载依赖
export function conditionalLoad(condition) {
  if (condition) {
    return import('lodash');
  } else {
    return import('underscore');
  }
}

// 示例 19: 异步加载依赖
export async function asyncLoadDependencies() {
  const [lodash, axios, moment] = await Promise.all([
    import('lodash'),
    import('axios'),
    import('moment')
  ]);
  
  return { lodash, axios, moment };
}

// 示例 20: 懒加载依赖
export function lazyLoadDependency() {
  return () => import('lodash');
}
